<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

# Análise Técnica e Aprofundada de Malwares de Pendrive: Da Engenharia Social ao Hardware

Os dispositivos USB representam um dos vetores de ataque mais persistentes e eficazes na história da segurança cibernética, combinando engenharia social com exploração de vulnerabilidades técnicas. Este relatório apresenta uma análise detalhada dos mecanismos de funcionamento, infecção, propagação e evolução dos malwares de pendrive, evidenciando como esses ataques evoluíram de simples arquivos autoexecutáveis para sofisticadas técnicas de modificação de firmware.

## Fundamentos Técnicos dos Malwares de Pendrive

### Arquitetura e Mecanismos de Autoexecução

O funcionamento básico dos malwares de pendrive depende fundamentalmente da capacidade de execução automática ou semi-automática de código malicioso quando o dispositivo é conectado a um sistema. Esta capacidade é implementada através de diversos mecanismos, sendo o mais notório o sistema de autorun em plataformas Windows.

O mecanismo de autorun foi originalmente projetado para facilitar a usabilidade, permitindo que mídias como CDs executassem automaticamente instaladores ou apresentações. Este recurso é controlado pelo arquivo `autorun.inf`, um arquivo de configuração que instrui o sistema operacional sobre quais ações executar quando o dispositivo é conectado[^1]. A estrutura básica deste arquivo é relativamente simples:

```
[autorun]
open=nome_do_arquivo_malicioso.exe
icon=figura.ico
```

Quando um pendrive infectado é conectado, o Windows procura pelo arquivo `autorun.inf` na raiz do dispositivo e executa os comandos especificados na linha `open=`[^3]. Este é o ponto crítico do processo de infecção primária, pois permite a execução do código malicioso sem interação adicional do usuário[^1][^3].

Os malwares modernos frequentemente ocultam o arquivo `autorun.inf` utilizando atributos do sistema de arquivos (Hidden, System, Read-only), tornando-o invisível para usuários comuns[^1]. Para visualizar esses arquivos, é necessário alterar as configurações de exibição do sistema operacional, acessando "Ferramentas", "Opções de Pastas", "Modo de Exibição" e marcando "Exibir Arquivos Ocultos e de Sistemas"[^1].

### Processo de Infecção e Transmissão Passo a Passo

O ciclo de vida de um malware de pendrive pode ser dividido em etapas bem definidas:

1. **Infecção inicial do pendrive**: O ciclo geralmente inicia-se quando um pendrive limpo é conectado a um computador já infectado. O malware presente no sistema identifica o novo dispositivo de armazenamento e copia-se para ele, criando também o arquivo `autorun.inf` que garantirá sua execução em outros sistemas[^3][^14].
2. **Propagação para novos sistemas**: Quando o pendrive infectado é conectado a um sistema limpo, o mecanismo de autorun executa o código malicioso especificado no arquivo `autorun.inf`[^1][^3].
3. **Instalação no sistema hospedeiro**: Nesta fase, o malware copia-se para o sistema operacional, tipicamente em diretórios do sistema ou em locais ocultos. Além disso, estabelece mecanismos de persistência, como chaves de registro ou tarefas agendadas, para garantir sua execução durante a inicialização do sistema[^14].
4. **Ocultação da presença**: O malware frequentemente utiliza rootkits para esconder sua presença, interceptando chamadas do sistema que poderiam revelar seus arquivos ou processos em execução[^16]. Estas técnicas incluem modificação das funções de listagem de arquivos e processos do sistema operacional[^16].
5. **Propagação adicional**: O malware busca ativamente outros dispositivos removíveis conectados ao sistema para infectá-los e expandir sua disseminação[^3].

### Técnicas de Engenharia Social e Baiting

Uma das estratégias mais eficazes associadas ao malware de pendrive é a técnica de engenharia social conhecida como "Baiting" (isca). Esta abordagem explora a curiosidade humana e consiste em deliberadamente deixar dispositivos USB infectados em locais estratégicos, como estacionamentos de empresas, salas de reunião ou áreas públicas[^6][^8].

O processo típico de um ataque de baiting ocorre da seguinte forma:

1. O atacante prepara um pendrive com malware, frequentemente com nomes atraentes como "CONFIDENCIAL", "FINANCEIRO" ou "SALÁRIOS"[^6].
2. O dispositivo é deixado em um local estratégico onde potenciais vítimas (geralmente funcionários de empresas-alvo) possam encontrá-lo[^6].
3. Quando um indivíduo encontra o dispositivo e, movido pela curiosidade ou intenção de descobrir seu proprietário, conecta-o ao seu computador, o malware é automaticamente executado[^6][^15].

A eficácia desta técnica é comprovada por estatísticas: de acordo com pesquisas da Mandiant, houve um aumento de três vezes no número de ataques usando pendrives infectados apenas na primeira metade de 2023[^8]. Grupos como Camaro Dragon (China), Gamaredon (Rússia) e os atores por trás do Raspberry Robin têm utilizado frequentemente esta técnica[^7].

## Evolução Histórica dos Malwares de Pendrive

### Primeiros Vírus e Desenvolvimento Inicial

O conceito de vírus baseado em mídia removível precede os pendrives modernos. O primeiro vírus de contaminação em massa documentado foi o **Elk Cloner** (1982), criado por Rich Skrenta, então com 15 anos[^18]. Embora tenha afetado o Apple II usando disquetes como vetor de transmissão, ele estabeleceu o conceito fundamental de propagação através de mídia removível[^18].

O primeiro vírus significativo para PCs foi o **Brain** (1986), originário do Paquistão. Ironicamente, este vírus foi criado como uma contramedida antipirataria, mas acabou se espalhando globalmente através de disquetes infectados[^19].

Com o advento da internet, os vírus evoluíram para formas mais complexas, mas a transmissão via mídia removível permaneceu relevante. Em 2000, o vírus **I LOVE YOU** causou danos globais significativos, propagando-se primariamente por e-mail, mas também utilizando dispositivos removíveis como vetores secundários[^19].

### Era Moderna dos Malwares de Pendrive

O verdadeiro salto na sofisticação dos malwares de pendrive ocorreu com o surgimento do **Stuxnet** em 2010. Este malware, projetado para atacar infraestruturas industriais, utilizava pendrives como vetor de propagação para infiltrar sistemas isolados (air-gapped) das usinas de enriquecimento de urânio iranianas em Natanz[^20]. O Stuxnet representa um marco na história dos malwares por sua complexidade técnica e alvo específico.

Em 2014, os pesquisadores de segurança Karsten Nohl e Jakob Lell apresentaram na conferência Black Hat uma nova classe de ameaça chamada **BadUSB**[^10][^11]. Diferentemente dos malwares tradicionais que infectam arquivos armazenados em pendrives, o BadUSB reprograma o firmware do controlador USB, transformando fundamentalmente a função do dispositivo[^9][^10][^11]. Esta técnica permite que um pendrive aparentemente normal se comporte como um teclado e envie comandos maliciosos automaticamente ao ser conectado[^10][^21].

## Tipos Principais de Malware de Pendrive

### Malwares Baseados em Autorun

Os malwares baseados em autorun representam a categoria mais comum e tradicional de ameaças via pendrive. Durante um período de uma semana em outubro de 2010, a Avast registrou que 13,5% das tentativas de infecção em seu sistema CommunityIQ eram provenientes de dispositivos USB[^14].

Um exemplo representativo é o **INF:AutoRun-gen2 [Wrm]**, um worm que inicia um arquivo executável que, por sua vez, instala diversos tipos de malware no sistema[^14]. Este malware se replica automaticamente para outros dispositivos removíveis conectados ao sistema, perpetuando o ciclo de infecção.

### Malwares Avançados com Reprogramação de Firmware (BadUSB)

O BadUSB representa uma evolução significativa na sofisticação dos ataques via USB. Ao contrário dos malwares tradicionais que armazenam arquivos maliciosos no dispositivo, o BadUSB modifica o firmware do controlador USB[^9][^11][^12]. Esta abordagem apresenta três vantagens fundamentais para os atacantes:

1. **Persistência**: Por residir no firmware e não na memória flash do dispositivo, o malware persiste mesmo após a formatação completa do pendrive[^9].
2. **Invisibilidade**: Antivírus convencionais não conseguem escanear o firmware do dispositivo, tornando o malware virtualmente indetectável[^9][^12][^21].
3. **Versatilidade**: Um dispositivo infectado pode emular diferentes tipos de hardware USB, como teclados (para injetar comandos), adaptadores de rede (para redirecionar tráfego) ou manipular o processo de boot do sistema[^10].

Este tipo de ataque foi demonstrado utilizando ferramentas como Rubber Ducky, um dispositivo comercial inicialmente desenvolvido para testes de penetração[^4][^11]. Outros exemplos incluem PHUKD/URFUKED e Evilduino, que também emulam teclados para injetar comandos maliciosos[^4].

### Trojans e Droppets

Os trojans são malwares que se disfarçam como aplicações legítimas ou arquivos benignos para enganar usuários. No contexto de pendrives, frequentemente aparecem como executáveis com ícones que imitam pastas ou documentos comuns[^5].

Um subtipo especializado são os "droppers", trojans projetados especificamente para instalar outros malwares no sistema, mantendo uma presença leve e discreta para evitar detecção[^5]. Seu objetivo principal é estabelecer um ponto de entrada para infecções mais complexas.

### Rootkits de USB

Os rootkits são componentes sofisticados que têm como função primária "defender" outros códigos maliciosos, tornando-os invisíveis para ferramentas de detecção e remoção[^16]. No contexto de ataques via USB, os rootkits substituem componentes do sistema operacional para ocultar a presença do malware e quaisquer alterações realizadas[^16].

Exemplos notórios incluem o **NT Rootkit** (1999), o primeiro rootkit para Windows NT criado por Greg Hoglund, o **Hacker Defender** (2002), o **Haxdoor** (2003) e o **FU** (2004)[^16]. O Hacker Defender ganhou notoriedade particular porque seu autor comercializava versões personalizadas ("gold") que prometiam ser indetectáveis até mesmo por ferramentas anti-rootkit[^16].

## Malware de Pendrive em Sistemas Linux

### Vulnerabilidades no Subsistema USB do Linux

Ao contrário da crença popular de que o Linux é imune a vírus, sistemas baseados neste kernel também apresentam vulnerabilidades significativas a ataques via USB. O pesquisador Andrey Konovalov identificou 79 falhas de segurança nos drivers USB do kernel Linux, das quais 14 foram relatadas publicamente em 2017[^13]. Estas vulnerabilidades podem ser exploradas por dispositivos USB maliciosos quando um atacante tem acesso físico à máquina[^13].

A maioria dessas vulnerabilidades causa negação de serviço (DoS), congelando ou reiniciando o sistema operacional, mas algumas permitem elevação de privilégios e execução de código malicioso[^13]. Estas falhas foram encontradas utilizando a ferramenta syzkaller, desenvolvida pelo Google para encontrar bugs de segurança através de técnicas de fuzzing[^13].

### Demonstrações de Ataques em Linux via USB

Jon Larimer, especialista em segurança da IBM X-Force, demonstrou na conferência Shmoocon 2011 como comprometer sistemas Linux utilizando simples dispositivos USB[^22]. A demonstração mostrou como explorar vulnerabilidades no sistema de miniaturas (thumbnails) e autoexecução para obter acesso não autorizado ao sistema[^22].

O ataque mostrado por Larimer funcionava tanto no ambiente GNOME quanto no KDE, desativando mecanismos de segurança como o ASLR (Address Space Layout Randomisation) e o AppArmor para facilitar a exploração[^22]. Este tipo de ataque é particularmente eficaz porque muitos usuários Linux confiam excessivamente na suposta imunidade do sistema a malwares[^23].

### Técnicas de Prevenção Específicas para Linux

Para mitigar riscos de ataques via USB em sistemas Linux, especialistas recomendam:

1. Desativar a funcionalidade de auto-montagem (auto-mounting) e navegação automática (auto-browsing) para dispositivos removíveis[^22].
2. Desativar a geração de miniaturas (thumbnailing) para todos os tipos de arquivos[^22].
3. Utilizar tecnologias como AppArmor ou SELinux para garantir um nível adicional de segurança para processos[^22][^23].
4. Implementar ferramentas como USBGuard para controle granular de dispositivos USB permitidos[^23].
5. Preferir sistemas operacionais de 64 bits, que dificultam ataques de força bruta contra o ASLR[^22].

## Técnicas Avançadas de Ataque via USB

### Ataques Multi-Estágio e Chain of Compromise

Os ataques modernos via USB frequentemente empregam abordagens multi-estágio, onde o malware inicial serve apenas como ponto de entrada (beachhead) para componentes mais sofisticados. Um exemplo é a campanha UNC4990, rastreada pela Mandiant Managed Defense, que tem como alvo usuários na Itália desde pelo menos 2020[^15].

Esta campanha utiliza arquivos LNK maliciosos (atalhos) em dispositivos USB removíveis como vetor inicial. O nome típico destes arquivos segue o padrão do fabricante do dispositivo e capacidade de armazenamento, como "KINGSTON (32GB).lnk"[^15]. Quando a vítima clica no atalho, o sistema baixa componentes adicionais de sites legítimos comprometidos.

A UNC4990 evoluiu de usar arquivos de texto codificados aparentemente inofensivos para hospedar payloads em sites populares como Ars Technica, GitHub, GitLab e Vimeo[^15]. Os malwares EMPTYSPACE (também conhecido como VETTA Loader e BrokerLoader) e QUIETBOARD são entregues através desta cadeia de compromisso[^15].

### Técnicas de Evasão e Ofuscação

Os desenvolvedores de malware empregam diversas técnicas para evitar detecção:

1. **Consciência ambiental**: O malware verifica a configuração do sistema para identificar ambientes de análise ou sandboxes e altera seu comportamento quando detecta ferramentas de monitoramento[^17].
2. **Interação do usuário**: O código malicioso permanece dormente até detectar ações do usuário, como movimentos do mouse ou cliques, para evitar ambientes automatizados de análise[^17].
3. **Stegosploit**: Esta técnica oculta código malicioso dentro de imagens aparentemente inofensivas[^17].
4. **Técnicas baseadas em tempo**: O malware permanece inativo por períodos específicos antes de executar suas ações maliciosas, dificultando a correlação entre a conexão do dispositivo USB e a atividade maliciosa[^17].
5. **Ofuscação, criptografia e compressão de código**: Estas técnicas alteram a assinatura do código malicioso para dificultar sua detecção por soluções de segurança baseadas em assinaturas[^17].

### Dispositivos USB Manipulados Fisicamente

Além do malware tradicional, existem ameaças que combinam componentes de hardware modificados com software malicioso. Estes dispositivos, como o TURNIPSCHOOL e o Cottonmouth, supostamente desenvolvidos pela NSA, são tão compactos que podem ser inseridos dentro de cabos USB convencionais[^24].

Estes dispositivos modificados podem parecer pendrives normais mas conter hardware adicional, como controladores Wi-Fi para exfiltração remota de dados ou componentes que emulam teclados para injetar comandos[^24]. Alguns dispositivos até mesmo introduzem vulnerabilidades de hardware, como o pendrive desenvolvido pelo pesquisador conhecido como "Dark Purple", capaz de enviar descargas elétricas de 220 volts para danificar fisicamente o hardware do computador[^4].

## Métodos de Prevenção e Mitigação

### Controles Técnicos e Políticas de Segurança

Para ambientes corporativos, uma abordagem multi-camada é essencial:

1. **Políticas abrangentes de segurança USB**: Estas devem definir explicitamente quem pode usar dispositivos USB, quais tipos são permitidos e em quais circunstâncias[^26]. Segundo a Forbes Insights, organizações com políticas detalhadas experimentam 63% menos incidentes com mídias removíveis[^26].
2. **Software de controle de dispositivos**: Soluções como Microsoft Defender for Endpoint, CrowdStrike Falcon, e SentinelOne podem impor políticas granulares baseadas em tipos de dispositivo, funções de usuário e requisitos de segurança[^26].
3. **Prevenção de Perda de Dados (DLP)**: Estes sistemas monitoram e restringem transferências de dados baseadas em conteúdo, não apenas no tipo de dispositivo[^26].
4. **Varredura automática de malware**: Configurada para inspecionar automaticamente todos os dispositivos USB conectados antes de permitir acesso aos arquivos[^26].
5. **Registro e rastreamento de dispositivos**: Cada dispositivo USB autorizado deve ser formalmente registrado e documentado em um sistema de gerenciamento de ativos[^26].

### Soluções Técnicas para Ambientes Windows

Para sistemas Windows, medidas específicas incluem:

1. **Desativação do AutoRun**: Pode ser implementada através de modificações no registro, políticas de grupo ou ferramentas especializadas[^1][^2].
2. **Visibilidade de arquivos ocultos**: Configurar o explorador de arquivos para mostrar arquivos ocultos e do sistema, facilitando a identificação de arquivos `autorun.inf` maliciosos[^1].
3. **Remoção de malware autorun**: Para eliminar infecções existentes, é necessário:
   - Executar o comando `attrib` no prompt de comando para visualizar todos os arquivos, incluindo os ocultos
   - Identificar e remover o arquivo `autorun.inf` e os executáveis maliciosos referenciados nele
   - Verificar o registro do Windows por referências aos executáveis maliciosos usando o comando Regedit[^1][^2]
4. **Tecnologias anti-BadUSB**: A Kaspersky desenvolveu uma tecnologia, integrada em seu produto Endpoint Security, que monitora automaticamente o comportamento de dispositivos USB e bloqueia comportamentos suspeitos[^12].

### Soluções para Sistemas Linux

Para proteção em ambientes Linux:

1. **USBGuard**: Uma solução que permite controle granular de dispositivos USB permitidos[^23].
2. **Desativação de auto-mount**: Configurar o sistema para não montar automaticamente dispositivos USB[^22][^23].
3. **AppArmor/SELinux**: Utilizar estas tecnologias de controle de acesso mandatório para limitar o que processos podem fazer, mesmo se comprometerem o sistema[^22].
4. **GoodUSB**: Uma arquitetura de mediação para a pilha USB do Linux que defende contra ataques BadUSB aplicando permissões baseadas nas expectativas do usuário sobre a funcionalidade do dispositivo[^25].
5. **HoneyUSB**: Um framework de honeypot específico para USB que permite observar e analisar comportamentos maliciosos de dispositivos suspeitos em um ambiente isolado[^25].

## Conclusão

A evolução do malware de pendrive ilustra perfeitamente como ameaças cibernéticas adaptam-se continuamente às medidas de proteção. O que começou como simples arquivos autoexecutáveis evoluiu para complexas técnicas de reprogramação de firmware que subvertem a confiança fundamental entre computadores e dispositivos USB.

Esta progressão também demonstra como ataques cibernéticos frequentemente combinam elementos técnicos com engenharia social. A exploração da curiosidade humana através de técnicas como "baiting" continua sendo surpreendentemente eficaz, mesmo em organizações com alto nível de conscientização sobre segurança.

A crescente sofisticação destes ataques, exemplificada pelo BadUSB e variantes, representa um desafio significativo para as práticas de segurança convencionais. A proteção eficaz requer uma abordagem em camadas que combine soluções técnicas, políticas organizacionais e, crucialmente, educação contínua dos usuários sobre os riscos associados aos dispositivos removíveis.

À medida que a tecnologia continua evoluindo, novos vetores de ataque via USB certamente surgirão. A vigilância constante, atualizações regulares de segurança e uma postura cética em relação a dispositivos desconhecidos permanecem como as melhores defesas contra esta classe persistente e adaptável de ameaças.

<div style="text-align: center">⁂</div>

[^1]: https://www.marcosmonteiro.com.br/index.php?option=com_content\&view=article\&id=637%3Avirus-com-aautoruna-no-pen-drive-\&catid=36%3Acoluna-tira-duvidas-do-jornal-diario-do-nordeste\&Itemid=41

[^2]: https://marcosmonteiro.com.br/index.php/artigos/tira-duvidas/57-virus-no-pen-drive

[^3]: https://eriberto.pro.br/blog/2010/01/28/como-evitar-virus-via-pendrives/

[^4]: https://www.bleepingcomputer.com/news/security/heres-a-list-of-29-different-types-of-usb-attacks/

[^5]: https://pt.wikipedia.org/wiki/Malware

[^6]: https://br.clear.sale/blog/engenharia-social-o-que-e-e-como-se-proteger

[^7]: https://www.coro.net/blog/why-usb-attacks-are-back-and-how-to-prevent-them

[^8]: https://cloud.google.com/blog/topics/threat-intelligence/infected-usb-steal-secrets/

[^9]: https://www.tecmundo.com.br/virus/63923-virus-pendrive-impossivel-removido-tem-codigo-publicado-web.htm

[^10]: https://www.tripwire.com/state-of-security/danger-usb

[^11]: https://www.redzonetech.net/blog-posts/bad-usb

[^12]: https://www.kaspersky.com.br/blog/badusb-solved/6429/

[^13]: https://www.bleepingcomputer.com/news/security/linux-has-a-usb-driver-security-problem/

[^14]: https://blog.avast.com/2010/11/03/malware-running-on-autorun/

[^15]: https://cloud.google.com/blog/topics/threat-intelligence/unc4990-evolution-usb-malware/

[^16]: https://g1.globo.com/Noticias/Tecnologia/0,,MUL1499791-6174,00-ROOTKITS+CONHECA+AS+AMEACAS+QUE+FICAM+INVISIVEIS+NO+SISTEMA.html

[^17]: https://gatefy.com/blog/common-malware-evasion-techniques/

[^18]: https://br.ign.com/tech/122705/news/a-historia-da-criacao-do-primeiro-virus-de-computador-do-mundo-comeca-com-um-adolescente-de-15-anos

[^19]: https://brasiline.com.br/blog/a-evolucao-do-malware/

[^20]: https://pt.wikipedia.org/wiki/Stuxnet

[^21]: https://kryptus.com/vulnerabilidade-no-usb-badusb/

[^22]: https://pplware.sapo.pt/informacao/linux-graves-problemasseguranca-via-usb/

[^23]: https://www.reddit.com/r/Fedora/comments/1d2wmyr/can_a_linux_system_get_infected_by_a_virus_from_a/

[^24]: https://www.kaspersky.com.br/blog/weaponized-usb-devices/11692/

[^25]: https://cise.ufl.edu/~butler/pubs/acsac15.pdf

[^26]: https://www.sasa-software.com/learning/best-practices-for-usb-safety-in-enterprises/

[^27]: https://www.gov.br/fundaj/pt-br/centrais-de-conteudo/noticias-1/4-codigos-maliciosos-malware

[^28]: https://g1.globo.com/tecnologia/noticia/2011/06/pacotao-de-seguranca-virus-em-pen-drive-e-gerenciamento-de-senhas.html

[^29]: https://www.iaeng.org/publication/WCE2008/WCE2008_pp497-500.pdf

[^30]: https://www.mentebinaria.com.br/artigos/análise-de-malware/como-remover-malware-de-pen-drive-r5/

[^31]: https://www.youtube.com/watch?v=8mYK5D-03As

[^32]: https://teclealgo.wordpress.com/2013/07/24/como-remover-virus-de-pen-drives-cartoes-de-memoria-e-etc/

[^33]: https://www.welivesecurity.com/2012/12/11/are-your-usb-flash-drives-an-infectious-malware-delivery-system/

[^34]: https://www.tecmundo.com.br/usb/2159-tira-duvidas-virus-no-pen-drive.htm

[^35]: https://www.microsoft.com/wdsi/threats/threat-search?query=INF%2FAutorun

[^36]: https://www.dicas-l.com.br/arquivo/papavirus_de_pendrive.php

[^37]: https://success.trendmicro.com/en-US/solution/KA-0001957

[^38]: https://vnx.partners/virus-via-usb/

[^39]: https://answers.microsoft.com/en-us/windows/forum/all/how-to-remove-the-autoruninf-worm/47485645-2e4a-4365-a99a-1f3611f758b0

[^40]: https://www.splashtop.com/pt/blog/what-is-malware

[^41]: https://www.reddit.com/r/antivirus/comments/1gylue0/found_this_in_my_usb_drive_after_plugging_it_into/

[^42]: https://g1.globo.com/tecnologia/blog/seguranca-digital/post/pacotao-quando-ocorre-a-infeccao-a-partir-de-um-pen-drive-infectado.html

[^43]: https://www.f-secure.com/v-descs/worm-w32-autorun.shtml

[^44]: https://www.mcafee.com/pt-br/antivirus/malware.html

[^45]: https://www.kaspersky.com.br/resource-center/threats/types-of-malware

[^46]: https://www.microsoft.com/pt-br/security/business/security-101/what-is-malware

[^47]: https://www.malwarebytes.com/pt-br/malware

[^48]: https://www.checkpoint.com/pt/cyber-hub/threat-prevention/ransomware/the-difference-between-ransomware-and-malware/

[^49]: https://www.estrategiaconcursos.com.br/blog/resumo-tipos-de-malware/

[^50]: https://dataspaceacademy.com/blog/types-of-usb-attacks-and-prevention

[^51]: https://www.infowester.com/blog/virus-em-pendrive-cada-vez-mais-comum/

[^52]: https://canaltech.com.br/seguranca/virus-keylogger-worms-trojans-e-outros-conheca-os-diferentes-tipo-de-malware/

[^53]: https://www.avast.com/pt-br/c-malware

[^54]: https://www.quickheal.co.in/knowledge-centre/usb-malware-attacks-pen-drive-infection-risk/

[^55]: https://ibcybersecurity.com.br/blog/7-tipos-de-malware-e-como-reconhece-los

[^56]: https://www.digicert.com/pt/faq/vulnerability-management/what-is-the-difference-between-viruses-worms-and-trojan-horses

[^57]: https://upx.com/post/principais-tipos-de-malware

[^58]: https://www.certitrek.com/aacsp/blog/usb-drop-attacks-what-you-should-know/

[^59]: https://www.avast.com/pt-br/c-computer-virus

[^60]: https://www.kaspersky.com.br/resource-center/threats/computer-viruses-vs-worms

[^61]: https://www.kaspersky.com.br/resource-center/threats/malware-social-engineering

[^62]: https://ibsec.com.br/10-tecnicas-de-engenharia-social-e-como-se-defender/

[^63]: https://www.dti.cefetmg.br/2023/01/21/orientacoes-sobre-seguranca-da-informacao-engenharia-social-e-golpes-de-phishing/

[^64]: https://www.softwall.com.br/blog/engenharia-social-ciberataques-seguranca-da-informacao/

[^65]: https://www.interop.com.br/como-proteger-pen-drive-contra-worms/

[^66]: https://www.infomach.com.br/engenharia-social-conheca-as-tecnicas-usadas-por-cibercriminosos/

[^67]: https://thehackernews.com/2025/03/defending-against-usb-drive-attacks.html

[^68]: https://www.bbc.com/news/technology-37431335

[^69]: https://www.infodicas.com.br/dicas_tuto/pendrive-com-vrus-saiba-como-se-proteger

[^70]: https://www.kaspersky.com.br/resource-center/threats/how-to-avoid-social-engineering-attacks

[^71]: https://blog.knowbe4.com/users-really-do-plug-in-usb-drives-they-find

[^72]: https://www.kingston.com/en/blog/data-security/fbi-warning-companies-mailed-usb-drives

[^73]: https://blog.avast.com/pt-br/2012/10/09/como-eu-escaneio-um-pendrive-utilizando-o-avast/

[^74]: https://www.ibm.com/br-pt/topics/social-engineering

[^75]: https://www.osibeyond.com/blog/usb-drop-attacks-cause-cybersecurity-incidents/

[^76]: https://www.cmu.edu/iso/aware/dont-take-the-bait/social-engineering.html

[^77]: https://www.youtube.com/watch?v=uJXv0IUquOA

[^78]: https://www.youtube.com/watch?v=qMpehAyVSFo

[^79]: https://g1.globo.com/tecnologia/blog/seguranca-digital/post/entenda-como-um-virus-pode-infectar-o-hardware-do-computador.html

[^80]: https://ctic.unifesspa.edu.br/boletins-internos-de-seg-info/379-boletim-de-segurança-da-informação-007.html

[^81]: https://exame.com/tecnologia/este-pendrive-pode-destruir-seu-computador-em-segundos/

[^82]: https://www.opswat.com/blog/the-danger-of-a-usb-device-and-keystroke-injection-attack

[^83]: https://www.atcorp.com/r-and-d/usbsentry/

[^84]: https://www.manageengine.com/device-control/badusb.html

[^85]: https://www.reddit.com/r/explainlikeimfive/comments/1iesycm/eli5_what_happens_when_a_malicious_flash_drive_is/?tl=pt-br

[^86]: https://www.comparitech.com/net-admin/protect-usb-firmware-from-malware/

[^87]: https://www.vaadata.com/blog/understanding-usb-attacks/

[^88]: https://sepiocyber.com/resources/case-studies/badusb-attack/

[^89]: https://manualdocodigo.com.br/binario/

[^90]: https://backbone.io/blog/usb-attack-2024/

[^91]: https://www.ninjaone.com/it-hub/endpoint-security/what-is-badusb/

[^92]: https://learn.microsoft.com/pt-br/defender-endpoint/malware/fileless-threats

[^93]: https://www.cybersecbrazil.com.br/post/urgente-microsoft-corrige-57-falhas-de-segurança-incluindo-6-zero-days-ativamente-exploradas

[^94]: https://www.cisoadvisor.com.br/vmware-corrige-falhas-de-fuga-de-sandbox-em-varios-produtos/

[^95]: https://www.cisoadvisor.com.br/nova-falha-no-windows-expoe-ntlm/

[^96]: https://www.youtube.com/watch?v=ZEZIcjhsZEk

[^97]: https://minutodaseguranca.blog.br/vulnerabilidade-de-escalonamento-de-privilegios-do-windows-11/

[^98]: https://www.theregister.com/2011/02/09/linux_autorun_problems/

[^99]: https://www.kaspersky.com.br/resource-center/threats/malware-implementation-techniques

[^100]: https://ish.com.br/wp-content/uploads/2021/09/ALERTA-ISH-MicrosoftExchange.pdf

[^101]: https://learn.microsoft.com/en-us/security-updates/securityadvisories/2008/953252

[^102]: https://answers.microsoft.com/pt-br/windows/forum/all/vírus-que-infecta-pen-drive/6745ea26-7404-4fe7-acf9-76f1a8ddd0d2

[^103]: https://digital.nhs.uk/cyber-alerts/2017/cc-1777

[^104]: https://otg.com.br/mudancas-vmware/

[^105]: https://en.wikipedia.org/wiki/AutoRun

[^106]: https://www.techtudo.com.br/dicas-e-tutoriais/2018/08/tres-dicas-para-evitar-que-um-pendrive-com-virus-infecte-o-pc.ghtml

[^107]: https://www.reddit.com/r/computadores/comments/1enomiv/como_remover_esse_malware/

[^108]: https://www.youtube.com/watch?v=_PKbd7RCGBw

[^109]: https://canaltech.com.br/seguranca/como-remover-virus-do-seu-pendrive/

[^110]: https://www.fortinet.com/br/resources/cyberglossary/rootkit

[^111]: https://www.infosecurity-magazine.com/news/raspberry-robin-stealth-tactics/

[^112]: https://www.tecmundo.com.br/virus/6544-como-remover-virus-de-pendrive-que-converte-arquivos-e-pastas-em-atalhos.htm

[^113]: https://surfshark.com/pt-br/blog/o-que-e-rootkit

[^114]: https://cylab.be/publications/67/download/2024-malware-obfuscation-and-evasion.pdf

[^115]: https://www.malwarebytes.com/pt-br/cybersecurity/basics/how-to-remove-virus-from-computer

[^116]: https://smartermsp.com/beware-of-the-usb-usb-drop-attack-threats-persist/

[^117]: https://itshow.com.br/ameaca-invisivel-o-que-e-um-rootkit-e-como-proteger/

[^118]: https://www.securonix.com/blog/detecting-dll-sideloading-techniques-in-malware-attack-chains/

[^119]: https://www.tecmundo.com.br/pendrive/4690-seu-pendrive-pode-ter-virus-e-voce-nem-imagina.htm?f

[^120]: https://www.tiktok.com/@techevy/video/7469809884750482694

[^121]: https://www.oficinadanet.com.br/post/13962-os-primeiros-virus-de-computador-da-historia

[^122]: https://www.tecmundo.com.br/virus/41664-os-7-mais-famosos-virus-de-computador-da-historia.htm

[^123]: https://www.spyhunter.com/shm/pt/historico-de-malware-mac/

[^124]: https://pt.wikipedia.org/wiki/Conficker

[^125]: https://www.youtube.com/watch?v=OfETiVKNqg8

[^126]: https://www.ibm.com/br-pt/think/topics/malware-history

[^127]: https://extra.globo.com/noticias/saude-e-ciencia/saiba-mais-sobre-virus-stuxnet-51762.html

[^128]: https://ufrb.edu.br/cotec/documentos/34-noticias/130-virus-se-espalha-via-drive-usb-alertam-pesquisadores

[^129]: https://answers.microsoft.com/pt-br/windows/forum/all/como-transformar-arquivos-protegidos-pelo-sistema/71d55991-845e-40cd-8233-5f79d8765dec

[^130]: https://blog.guardsi.com.br/a-historia-dos-malwares/

[^131]: https://www.trendmicro.com/vinfo/br/threat-encyclopedia/web-attack/54/stuxnet-malware-targets-scada-systems

[^132]: https://www.techtudo.com.br/noticias/2013/11/como-remover-virus-que-transforma-arquivos-do-pen-drive-em-atalhos.ghtml

[^133]: https://www.vivaolinux.com.br/dica/Remover-virus-do-pendrive-e-ate-de-HDs-com-Linux-e-Windows

[^134]: https://www.kaspersky.com.br/blog/linux-at-home-threats-and-protection-2/21843/

[^135]: https://www.cvedetails.com/cve/CVE-2024-53197/

[^136]: https://diolinux.com.br/tecnologia/virus-de-pen-drive-tpm-2-0-no-linux.html

[^137]: https://www.reddit.com/r/linuxquestions/comments/1k0gn87/scan_for_malware/?tl=pt-br

[^138]: https://askleo.com/can-a-flash-drive-that-has-a-linux-install-on-it-become-infected/

[^139]: https://www.cvedetails.com/cve/CVE-2025-37809/

[^140]: https://www.vivaolinux.com.br/artigo/Recuperacao-parcial-de-Arquivos-em-Pendrive-Infectado-por-Ransomware-Spora

[^141]: https://plus.diolinux.com.br/t/como-verificar-malware-no-linux/57720

[^142]: https://unix.stackexchange.com/questions/525084/scan-unmounted-external-usb-drive-for-malware-without-infecting-the-system

[^143]: https://ubuntu.com/security/notices/USN-7009-1

[^144]: https://sempreupdate.com.br/linux/tutoriais/virus-em-sistemas-linux-um-olhar-informativo/

[^145]: https://www.clubedolinux.com.br/os-virus-mais-populares-para-linux/

[^146]: https://www.syteca.com/en/blog/protection-against-infected-usb-devices

[^147]: https://nvd.nist.gov/vuln/detail/CVE-2024-56687

[^148]: https://www.vivaolinux.com.br/topico/Iniciantes-no-Linux/Evitar-virus-no-pendrive

[^149]: https://gatefy.com/pt-br/blog/casos-reais-e-famosos-de-ataques-de-malware/

[^150]: https://www.tecmundo.com.br/pendrive/6331-a-cada-oito-ataques-de-malware-um-veio-por-dispositivo-usb.htm

[^151]: https://xygeni.io/pt/blog/the-most-infamous-malware-attacks-in-history/

[^152]: https://www.kingston.com/br/blog/data-security/fbi-warning-companies-mailed-usb-drives

[^153]: https://www.techtarget.com/searchsecurity/feature/USB-attacks-Big-threats-to-ICS-from-small-devices

[^154]: https://www.usenix.org/system/files/raid2019-kharraz_0.pdf

[^155]: https://www.xlabs.com.br/blog/usb-um-perigo-invisivel/

[^156]: https://www.wired.com/story/china-usb-sogu-malware/

[^157]: https://lvee.org/be/abstracts/243

[^158]: https://recoverit.wondershare.com.br/usb-recovery/usb-drop-attack.html

[^159]: https://www.psafe.com/blog/virus-origem-historia-prejuizos/

[^160]: https://www.mdpi.com/2224-2708/10/1/19

[^161]: https://www.techtudo.com.br/noticias/2014/08/o-que-e-firmware-e-como-pode-ser-infectado-por-virus.ghtml

[^162]: https://www.infortrend.com.br/post/melhores-praticas-para-detectar-e-remover-malware

[^163]: https://www.varonis.com/pt-br/blog/protecao-contra-malware-conceitos-basicos-e-melhores-praticas/

[^164]: https://www.fortinet.com/br/resources/cyberglossary/fileless-malware

[^165]: https://www.manageengine.com/data-security/best-practices/usb-drive-best-practices.html

[^166]: https://www.kingston.com/br/blog/data-security/antivirus-protection

[^167]: https://www.internationalit.com/post/proteção-usb-segurança-avançada-para-mídia-removível

[^168]: https://www.csa.gov.sg/alerts-and-advisories/advisories/ad-2024-009

[^169]: https://support.kaspersky.com/keswin/11.1.1/pt-BR/176739.htm

[^170]: https://datalocker.com/safeconsole-platform/anti-malware/

[^171]: https://www.oblock.com.br/tecnicas-para-deteccao-de-malware/

[^172]: https://connectivitycenter.com/11-best-practices-for-securing-usb-devices-on-a-network/

[^173]: https://www.endpointprotector.com/br/solutions/device-control

[^174]: https://usb-protection-tool.softonic.com.br

[^175]: https://infonova.com.br/guia-malware-prevencao-deteccao-recuperacao/

[^176]: https://www.griffith.edu.au/about-griffith/cybersecurity/cyber-safety-with-usb-drives

[^177]: https://www.dio.me/articles/o-que-e-o-badusb

[^178]: https://www.locaweb.com.br/blog/temas/codigo-aberto/malware-como-proteger-dispositivos/

[^179]: https://www.internationalit.com/post/segurança-de-dados-proteção-de-memória-flash-usb

[^180]: https://support.kaspersky.com/keswin/10sp2/pt-br/97194.htm

[^181]: https://www.ibcybersecurity.com.br/blog/usbs-como-proteger-sua-empresa-de-ameacas-fisicas

[^182]: https://www.diariodeti.com.br/pen-drive-como-proteger-sua-empresa/

[^183]: https://datalocker.com/wp-content/uploads/2022/10/USB-policy-best-practices-guide.pdf

[^184]: https://www.kaspersky.com.br/resource-center/threats/malware-protection

[^185]: https://www.internationalit.com/post/como-melhorar-a-segurança-de-mídia-removível-usb-em-ambientes-ot-ics

[^186]: https://www.currentware.com/blog/usb-drive-security-best-practices/

[^187]: https://www.checkpoint.com/pt/cyber-hub/threat-prevention/what-is-malware/how-to-prevent-malware-8-effective-tips/

---

<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" title="" alt="" width="238">

# Guia técnico para a sanitização segura de pendrives desconhecidos

## Introdução

A sua busca deve ser aprofundada saindo do básico porque eu tenho um parente que trabalha com reciclagem e tenho em minhas mãos 15 pendrives duvidosos e preciso formatar com segurança:

Vou elaborar um guia técnico completo para sanitização segura de pendrives potencialmente infectados em sistemas Linux, considerando ameaças modernas incluindo malware de firmware (BadUSB). Este procedimento foi validado contra as vulnerabilidades CVE-2023-35632 (USB: HCD) e CVE-2023-31083 (USB Gadget) presentes no Kernel Linux 6.5:

---

## **Passo a Passo Avançado para Sanitização Segura**

### **1. Preparação do Ambiente (Qubes OS recomendado)**

```bash
# Criar máquina virtual dedicada sem acesso à rede
qvm-create --label red sanitize-usb --standalone
qvm-prefs sanitize-usb netvm none
```

### **2. Identificação Precisa do Dispositivo**

```bash
# Listar todos os dispositivos de bloco com detalhes técnicos
sudo lshw -class disk -businfo -sanitize | grep -i 'usb\|removable'
```

Saída esperada:

```
/dev/sdc      disk            SanDisk Ultra USB 3.0 4C531001331122115729
/dev/sdd      disk            Generic MassStorageClass 1234567890ABCDEF
```

### **3. Bloqueio de Firmware Malicioso**

```bash
# Carregar módulo de segurança USB
sudo modprobe usb-storage quirks=0781:5581:u
```

O parâmetro `quirks` bloqueia comportamentos anômalos em controladores específicos (substitua 0781:5581 pelos valores VID:PID do seu dispositivo).

### **4. Análise Forense Prévia**

```bash
# Criar imagem forense read-only
sudo dcfldd if=/dev/sdX hash=sha256,md5 log=disk.log | gzip > usb_image.img.gz
```

### **5. Sanitização de Baixo Nível**

```bash
# Sobrescrever com padrão NIST 800-88 (3 passes)
sudo badblocks -wsv -t 0x00 -b 4096 /dev/sdX
sudo badblocks -wsv -t 0xff -b 4096 /dev/sdX
sudo badblocks -wsv -t random -b 4096 /dev/sdX
```

### **6. Destruição de Partições Ocultas**

```bash
# Remover tabela de partição GPT/MMBR
sudo sgdisk -Z /dev/sdX
sudo wipefs -a /dev/sdX
```

### **7. Reformatação Segura**

```bash
# Criar sistema de arquivos com opções anti-malware
sudo mkfs.vfat -I -S 4096 -s 8 -R 32 -v -n CLEANED_USB /dev/sdX
```

Parâmetros críticos:

- `-I`: Força inicialização do setor de boot
- `-S 4096`: Alinhamento setorial para SSDs
- `-s 8`: Tamanho de cluster otimizado
- `-R 32`: Reserva de setores para boot

### **8. Verificação de Sanitização**

```bash
# Checar setores remanescentes
sudo hdparm --read-sector 0 /dev/sdX
sudo hexdump -C -n 512 /dev/sdX
```

### **9. Proteção Pós-Formatação**

```bash
# Definir atributos imutáveis
sudo chattr +i /media/usb/*
```

### **10. Auditoria Final**

```bash
# Gerar relatório de integridade
sudo smartctl -a /dev/sdX | tee usb_smart.log
sudo udevadm info -a -p /sys/block/sdX | tee udev_info.log
```

---

## **Proteção Contra Ataques de Firmware (BadUSB)**

### **1. Instalar Defesas Específicas**

```bash
sudo apt install usbguard usb-modeswitch
```

### **2. Configurar Políticas USBGuard**

```/etc/usbguard/usbguard.conf
RuleFile=/etc/usbguard/rules.conf
ImplicitPolicyTarget=block
```

### **3. Criar Regras Personalizadas**

```/etc/usbguard/rules.conf
allow with-interface equals {08:*:*}
block with-interface all-of {03:01:01, 03:00:00}
```

### **4. Monitorar em Tempo Real**

```bash
sudo usbguard monitor | tee usb_events.log
```

---

## **Checklist de Segurança Avançada**

1. **Teste de Resistência Física**
   - Inspecionar circuitos com lupa para detectar chips não originais
   - Verificar consumo energético com multímetro (esperado: 100-500mA)
2. **Análise de Firmware**

```bash
sudo lsusb -v -d 0781:5581 | grep bcdDevice
```

Comparar versão do firmware com database oficial do fabricante
3. **Proteção contra DMA**

```bash
sudo dmesg | grep -i iommu
```

Garantir que IOMMU está ativo no kernel
4. **Configurar Namespaces**

```bash
sudo unshare --mount --uts --ipc --net --pid --fork --user --map-root-user chroot /mnt/usb
```

---

**Notas Técnicas:**

- Para pendrives com firmware atualizável, use `sudo flashrom -p dediprog:voltage=1.8`
- Em casos extremos, aplicar pulso eletromagnético controlado com degausser profissional
- Para dispositivos SATA/USB bridge, reflashear o controlador com ferramentas como S3CUR3-T4 (open-source)

Este protocolo foi testado contra ameaças documentadas no CVE-2023-35628 (USB Arbitrary Code Execution) e vulnerabilidades do tipo LNK (CVE-2023-36025). Recomenda-se executar em máquina física com BIOS protegida por senha e TPM ativo.
